import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.Random;



public class MindModuleUnit extends DefinedData{
	
	String ProcessName = "MindModuleUnit";
	String SimulationMode;
	String MindModuleUnitState;
	String target;
	
	String TradeAction;
	
	BoardInfo BoardInfo;
	UserProperty UserProperty;
	TradeStatics TradeStatics;
	
	LogUnit MindMoudleLog;
	LogUnit ErrorLog;
	
	Random rnd ;
	
	MindModuleUnit(String target,BoardInfo BoardInfo, UserProperty UserProperty,TradeStatics TradeStatics,LogUnit ErrorLog,String SimulationMode){
		
		String SubProcessName = "Initiation";
		MindModuleUnitState = "PREPARE";
		//---------------------------初期設定----------------------------------------
		this.SimulationMode = SimulationMode;
		this.target = target;
		this.BoardInfo = BoardInfo;
		this.UserProperty = UserProperty;
		this.TradeStatics = TradeStatics;
		
		MindModuleUnitState = "READY";
		try{
		
			rnd = new Random();
		}catch(Exception e){
			System.out.println( e);
			ErrorLogWrite(ProcessName,SubProcessName, e.toString() );
		}	
	}
		
	public void run(){ 
		String SubProcessName = "Main_Loop ";
		System.out.println(target+ "	"+ProcessName+"_"+SimulationMode+"_"+"Standby" );
		String PreState = MindModuleUnitState;
		while(!MindModuleUnitState.equals("END")){
			switch(MindModuleUnitState){
			
			case "READY":
				//System.out.println( "DecisionMakingUnit READY");
				break;	
			case "START":	
				if (PreState.equals("READY")){
					//初回のプロセスの起動に使う
					PreState = MindModuleUnitState;
					System.out.println(target+ "	"+ProcessName+"_"+SimulationMode+"_"+"Start"+"Action Score"+ UserProperty.UserAction.ActionScore);
				}	
				try{
					UserProperty.UserAction.ActionScore = rnd.nextInt(10000);	
				}catch (Exception e){
					ErrorLogWrite(ProcessName, SubProcessName ,e.toString());
				}	
				
				System.out.println( target+ "	"+ProcessName+"_"+SimulationMode+"_"+"Start");
				break;
			case "PAUSE":
				//System.out.println( "DecisionMakingUnit PAUSE");
				break;
			case "FINISHING":
				//---------------気配板プロセスの完了待つ-----------------------------	
				/*while(!XXXX.equals("END")){
					try{
						Thread.sleep(10);
					}catch (InterruptedException e){
					}
				}*/
				//System.out.println( target+ "	"+ProcessName+"_"+"Finishing");
				MindModuleUnitState = "END";
				break;
			case "ERROR":	
				//System.out.println( target+ "	"+ProcessName+"_"+"Error");
				break;
				
			}	
			try{
				Thread.sleep(500);
			}catch (InterruptedException e){
				
			}	
		}		
		//start any web access process 
	}
	
	public void MindModule(){
		
	}
	
	void LogTitleInitial(){
		//Log Label 
		String temp; 
		temp =  "StaticsNumber	DataNumber	yyyy/MM/dd	HH:mm:ss.SSS	";
		temp = temp + "MarketChange_Online_Avg	PriceChange_Online_Avg	OverSell	TradeStatics.OverSell	";
		MindMoudleLog.FileWrite(temp);	
	}
	
	public void StaticsLogWrite(){
		String SubProcessName = "StaticsLogWrite";
    	Calendar rightNow;
    	Date Now = new Date();
    	SimpleDateFormat D = new SimpleDateFormat("yyyy/MM/dd	HH:mm:ss.SSS");
    	rightNow = Calendar.getInstance();
		Now = rightNow.getTime();
		
		final int StaticsNumber = 1;
		
		String temp = StaticsNumber +"	"+ BoardInfo.DataNumber+"	"+D.format(Now)+"	"; 
		
		temp =temp + TradeStatics.MarketChange_Online_Avg +"	"+ TradeStatics.PriceChange_Online_Avg +"	";		
		
		temp =temp + "OverSell	" + TradeStatics.OverSell +"	";

		for(int i = BoardInfo.BuyIndex; i > 1; i--){
			temp =temp + TradeStatics.Board[i][0]+"	"; 
			temp =temp + TradeStatics.Board[i][1]+"	"; 
		}
		MindMoudleLog.FileWrite(temp);	
	}	
	
	void ErrorLogWrite(String ProccessName, String SubProcessName , String Error){
		Calendar rightNow;
		Date Now = new Date();
    	SimpleDateFormat D = new SimpleDateFormat("yyyy/MM/dd	HH:mm:ss.SSS");
    	rightNow = Calendar.getInstance();
		Now = rightNow.getTime();
		
		String temp =  D.format(Now) + "	" + ProccessName + "	" + SubProcessName + "	" +Error +"\r\n";
		ErrorLog.FileWrite(temp);
		
	}
	
	//public void EnvironmentValidation(){ }// 市場判断
	//public void 
	

}
